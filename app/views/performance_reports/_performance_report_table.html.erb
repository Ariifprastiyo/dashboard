<div class="card">
  <div class="card-body">
    <h5 class="card-title">Initial vs Actual</h5>
    <table class="table table-bordered">
      <tr class="strong">
        <th rowspan="2" class="align-middle">Month</th>
        <th colspan="2">CPR</th>
        <th colspan="3">Reach</th>
        <th colspan="2">CPE</th>
        <th colspan="2">%CRB</th>
      </tr>
      <tr>
        <th>Initial Target</th>
        <th>Actual</th>
        <th>Initial Target</th>
        <th>Updated Target Plan</th>
        <th>Actual</th>
        <th>Initial Target</th>
        <th>Actual</th>
        <th>Initial Target</th>
        <th>Actual</th>
      </tr>

      <% @actual_reports.each do |report| %>
        <tr>
          <td><%= report[:month].strftime("%B") %></td>
          <td><%= number_to_currency @campaign.kpi_cpr %></td>
          <td><%= report[:total_cpr] %></td>
          <td><%= number_with_delimiter @campaign.kpi_reach %></td>
          <td>
            <%= turbo_frame_tag "#{report[:updated_reach_plan_dom_id]}" do %>
              <span><%= report[:updated_reach_plan] || '-' %></span>
              <%= link_to '(edit)', edit_campaign_reach_plan_performance_report_path(campaign_id: @campaign, date: report[:date_in_iso]) %>
            <% end %>
          </td>
          <td><%= report[:total_reach] %></td>
          <td><%= number_to_currency @campaign.kpi_cpe %></td>
          <td><%= report[:total_cpe] %></td>
          <td><%= number_to_percentage @campaign.kpi_crb, precision: 2 %></td>
          <td><%= report[:total_crb] %></td>
        </tr>
      <% end %>

      <tr class="fw-bold">
        <td>Total</td>
        <td><%= number_to_currency @campaign.kpi_cpr %></td>
        <td><%= number_to_currency @campaign.cpr %></td>
        <td><%= number_with_delimiter @campaign.kpi_reach %></td>
        <td></td>
        <td><%= number_with_delimiter @campaign.reach %></td>
        <td><%= number_to_currency @campaign.kpi_cpe %></td>
        <td><%= number_to_currency @campaign.cpe %></td>
        <td><%= number_to_percentage @campaign.kpi_crb, precision: 2 %></td>
        <td><%= number_to_percentage @campaign.crb, precision: 2 %></td>
      </tr>
    </table>
  </div>
</div>